<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GoToMarket Compliance Lab</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Sora:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.2/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.4/jspdf.plugin.autotable.min.js"></script>
<style>
  :root {
    --bg-0: #080B10;
    --bg-1: #0D1219;
    --bg-2: #131A24;
    --bg-3: #1A2435;
    --bg-4: #223046;
    --text-0: #F0F4F8;
    --text-1: #C1CEDC;
    --text-2: #8299B4;
    --text-3: #566B84;
    --accent: #2DD4A8;
    --accent-dim: #1FA880;
    --accent-glow: rgba(45,212,168,0.1);
    --accent-glow2: rgba(45,212,168,0.06);
    --gold: #E8B94A;
    --gold-dim: rgba(232,185,74,0.1);
    --success: #34D399; --success-dim: rgba(52,211,153,0.1);
    --warn: #FBBF24; --warn-dim: rgba(251,191,36,0.1);
    --danger: #F87171; --danger-dim: rgba(248,113,113,0.1);
    --info: #60A5FA; --info-dim: rgba(96,165,250,0.1);
    --border: rgba(255,255,255,0.06);
    --border-accent: rgba(45,212,168,0.25);
    --r: 14px; --r-lg: 20px;
    --font-d: 'Playfair Display', Georgia, serif;
    --font-b: 'Sora', sans-serif;
    --font-cn: 'Noto Sans SC', sans-serif;
    --font-m: 'JetBrains Mono', monospace;
    --pad: clamp(20px, 4vw, 56px);
  }
  *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
  body{font-family:var(--font-b);background:var(--bg-0);color:var(--text-0);min-height:100vh;overflow-x:hidden;font-size:15px;line-height:1.6}
  body::after{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");pointer-events:none;z-index:10000}
  ::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:var(--bg-0)}::-webkit-scrollbar-thumb{background:var(--bg-4);border-radius:3px}
  a{color:inherit;text-decoration:none}

  /* NAV */
  nav{position:fixed;top:0;left:0;right:0;z-index:100;height:60px;display:flex;align-items:center;justify-content:space-between;padding:0 var(--pad);background:rgba(8,11,16,0.85);backdrop-filter:blur(24px);border-bottom:1px solid var(--border)}
  .nav-brand{display:flex;align-items:center;gap:12px}
  .nav-logo{width:32px;height:32px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent-dim));display:flex;align-items:center;justify-content:center;font-weight:700;font-size:12px;color:var(--bg-0)}
  .nav-name{font-family:var(--font-d);font-size:17px;font-weight:600}.nav-name em{font-style:italic;color:var(--accent)}
  .nav-r{display:flex;align-items:center;gap:3px}
  .nav-link{padding:6px 14px;border-radius:7px;font-size:12px;font-weight:500;color:var(--text-2);cursor:pointer;transition:all .2s}
  .nav-link:hover{color:var(--text-0);background:var(--bg-3)}.nav-link.active{color:var(--accent);background:var(--accent-glow)}
  .lang-sw{display:flex;margin-left:12px;background:var(--bg-2);border-radius:7px;border:1px solid var(--border);overflow:hidden}
  .lang-btn{padding:5px 12px;font-size:11px;font-weight:600;background:transparent;border:none;color:var(--text-3);cursor:pointer;font-family:var(--font-b);transition:all .2s}
  .lang-btn.active{background:var(--accent);color:var(--bg-0)}

  /* HERO â€” compact */
  .hero{padding:90px var(--pad) 40px;position:relative;overflow:hidden}
  .hero-orb{position:absolute;border-radius:50%;pointer-events:none;filter:blur(90px);opacity:.35}
  .hero-orb-1{width:500px;height:500px;top:-120px;right:-80px;background:radial-gradient(circle,rgba(45,212,168,.16),transparent 70%);animation:of 12s ease-in-out infinite}
  .hero-orb-2{width:350px;height:350px;bottom:-80px;left:8%;background:radial-gradient(circle,rgba(96,165,250,.08),transparent 70%);animation:of 15s ease-in-out infinite reverse}
  @keyframes of{0%,100%{transform:translate(0,0) scale(1)}50%{transform:translate(25px,-15px) scale(1.06)}}
  .hero-grid{position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.018) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.018) 1px,transparent 1px);background-size:64px 64px;mask-image:radial-gradient(ellipse at 65% 35%,black 10%,transparent 60%)}
  .hero-inner{position:relative;max-width:800px;width:100%}
  .hero-badge{display:inline-flex;align-items:center;gap:8px;padding:5px 16px;border-radius:100px;background:var(--accent-glow);border:1px solid var(--border-accent);font-size:11px;font-weight:600;color:var(--accent);text-transform:uppercase;letter-spacing:1.2px;margin-bottom:24px;animation:fu .5s ease both}
  .hero-badge::before{content:'';width:5px;height:5px;background:var(--accent);border-radius:50%;animation:pu 2s infinite}
  @keyframes pu{0%,100%{opacity:1}50%{opacity:.3}}
  .hero h1{font-family:var(--font-d);font-size:clamp(36px,5vw,60px);line-height:1.1;letter-spacing:-1.5px;font-weight:700;margin-bottom:16px;animation:fu .5s .06s ease both}
  .hero h1 em{font-style:italic;background:linear-gradient(135deg,var(--accent),#60A5FA);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
  .hero-desc{font-size:16px;line-height:1.7;color:var(--text-1);max-width:560px;margin-bottom:28px;animation:fu .5s .12s ease both}
  .hero-actions{display:flex;gap:12px;flex-wrap:wrap;margin-bottom:40px;animation:fu .5s .18s ease both}
  @keyframes fu{from{opacity:0;transform:translateY(22px)}to{opacity:1;transform:translateY(0)}}
  .btn{padding:12px 26px;border-radius:10px;font-size:13px;font-weight:600;font-family:var(--font-b);cursor:pointer;transition:all .25s;border:none;display:inline-flex;align-items:center;gap:9px}
  .btn-accent{background:linear-gradient(135deg,var(--accent),var(--accent-dim));color:var(--bg-0);box-shadow:0 4px 18px rgba(45,212,168,.22),inset 0 1px 0 rgba(255,255,255,.12)}
  .btn-accent:hover{transform:translateY(-2px);box-shadow:0 8px 28px rgba(45,212,168,.32),inset 0 1px 0 rgba(255,255,255,.12)}
  .btn-ghost{background:var(--bg-3);color:var(--text-0);border:1px solid var(--border)}
  .btn-ghost:hover{background:var(--bg-4);border-color:var(--text-3)}
  .btn-sm{padding:9px 20px;font-size:12px;border-radius:8px}

  /* UPLOAD */
  .upload-row{display:grid;grid-template-columns:1fr 1fr;gap:20px;animation:fu .5s .24s ease both}
  .upload-zone{background:var(--bg-2);border:2px dashed rgba(45,212,168,.18);border-radius:var(--r-lg);padding:36px 28px;text-align:center;cursor:pointer;transition:all .3s}
  .upload-zone:hover,.upload-zone.dragover{border-color:var(--accent);background:var(--bg-3);box-shadow:0 0 30px rgba(45,212,168,.05)}
  .upload-icon-wrap{width:60px;height:60px;margin:0 auto 16px;border-radius:16px;background:linear-gradient(135deg,var(--accent-glow),var(--accent-glow2));border:1px solid var(--border-accent);display:flex;align-items:center;justify-content:center;font-size:28px}
  .upload-title{font-size:15px;font-weight:600;margin-bottom:5px}
  .upload-desc{font-size:12px;color:var(--text-3);line-height:1.5}
  .upload-formats{margin-top:14px;display:flex;justify-content:center;gap:6px}
  .fmt{padding:3px 10px;border-radius:5px;background:var(--bg-4);font-size:9px;font-weight:700;color:var(--text-3);letter-spacing:.8px;font-family:var(--font-m)}
  .file-list{margin-top:14px;display:flex;flex-direction:column;gap:6px}
  .file-item{display:flex;align-items:center;gap:8px;padding:8px 12px;border-radius:8px;background:var(--bg-3);font-size:12px;animation:fu .25s ease both}
  .file-item .fn{flex:1;color:var(--text-1);font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
  .file-item .fs{color:var(--text-3);font-size:10px;font-family:var(--font-m)}
  .file-item .fx{width:20px;height:20px;border-radius:5px;background:var(--danger-dim);border:none;color:var(--danger);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:10px;transition:all .2s}
  .file-item .fx:hover{background:var(--danger);color:#fff}

  .upload-info{background:var(--bg-2);border-radius:var(--r-lg);border:1px solid var(--border);padding:28px;display:flex;flex-direction:column;justify-content:center}
  .info-title{font-size:14px;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px}
  .info-list{display:flex;flex-direction:column;gap:10px}
  .info-item{display:flex;align-items:flex-start;gap:10px;font-size:13px;color:var(--text-1)}
  .info-dot{width:24px;height:24px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0}
  .iit-t{font-weight:600;font-size:12px;margin-bottom:1px}
  .iit-d{font-size:11px;color:var(--text-3);line-height:1.4}

  /* Analyze button & status */
  .analyze-bar{margin-top:20px;display:flex;align-items:center;gap:16px;animation:fu .5s .3s ease both}
  .analyze-status{font-size:13px;color:var(--text-2)}
  .analyze-status.error{color:var(--danger)}
  .spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--bg-4);border-top-color:var(--accent);border-radius:50%;animation:spin .6s linear infinite;margin-right:8px}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* SECTION COMMON */
  .section{padding:60px var(--pad)}
  .divider{height:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);margin:0 var(--pad)}
  .sec-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:2.5px;color:var(--accent);margin-bottom:10px;font-family:var(--font-m)}
  .sec-title{font-family:var(--font-d);font-size:clamp(26px,3vw,38px);letter-spacing:-.8px;font-weight:700;margin-bottom:10px;line-height:1.15}
  .sec-desc{font-size:14px;color:var(--text-2);max-width:540px;line-height:1.7;margin-bottom:40px}

  /* SERVICES */
  .svc-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:14px}
  .svc-card{background:var(--bg-2);border-radius:var(--r-lg);border:1px solid var(--border);padding:26px 20px;transition:all .3s;cursor:default;position:relative;overflow:hidden}
  .svc-card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--accent);transform:scaleX(0);transform-origin:left;transition:transform .3s}
  .svc-card:hover{border-color:var(--border-accent);transform:translateY(-3px);box-shadow:0 10px 30px rgba(0,0,0,.25)}
  .svc-card:hover::before{transform:scaleX(1)}
  .svc-icon{font-size:24px;margin-bottom:14px;width:44px;height:44px;border-radius:12px;display:flex;align-items:center;justify-content:center}
  .svc-num{font-family:var(--font-m);font-size:10px;color:var(--text-3);margin-bottom:8px;letter-spacing:1px}
  .svc-t{font-size:13px;font-weight:600;margin-bottom:8px;line-height:1.3}
  .svc-d{font-size:11px;color:var(--text-3);line-height:1.5}

  /* LAYERS */
  .layers{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
  .ly-card{background:var(--bg-1);border-radius:var(--r-lg);border:1px solid var(--border);overflow:hidden;transition:all .3s}
  .ly-card:hover{border-color:var(--border-accent);transform:translateY(-2px)}
  .ly-bar{height:3px}
  .ly-1 .ly-bar{background:linear-gradient(90deg,var(--accent),transparent)}
  .ly-2 .ly-bar{background:linear-gradient(90deg,var(--gold),transparent)}
  .ly-3 .ly-bar{background:linear-gradient(90deg,var(--info),transparent)}
  .ly-hd{padding:24px 22px 18px;position:relative}
  .ly-num{font-family:var(--font-d);font-size:60px;font-weight:700;color:rgba(255,255,255,.025);position:absolute;top:8px;right:16px;line-height:1}
  .ly-tag{display:inline-flex;padding:3px 10px;border-radius:5px;font-size:10px;font-weight:700;letter-spacing:1px;text-transform:uppercase;margin-bottom:12px;font-family:var(--font-m)}
  .ly-1 .ly-tag{background:var(--accent-glow);color:var(--accent)}
  .ly-2 .ly-tag{background:var(--gold-dim);color:var(--gold)}
  .ly-3 .ly-tag{background:var(--info-dim);color:var(--info)}
  .ly-title{font-family:var(--font-d);font-size:19px;font-weight:700;margin-bottom:4px}
  .ly-cn{font-family:var(--font-cn);font-size:13px;color:var(--text-2)}
  .ly-desc{font-size:12px;color:var(--text-3);line-height:1.6;padding:0 22px 22px}

  /* DASHBOARD */
  .dash-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
  .dash-card{background:var(--bg-2);border-radius:var(--r-lg);border:1px solid var(--border);overflow:hidden;transition:all .3s}
  .dash-card:hover{border-color:rgba(255,255,255,.08)}
  .dash-hd{padding:16px 20px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
  .dash-t{font-size:13px;font-weight:600;display:flex;align-items:center;gap:8px}
  .dash-body{padding:18px 20px}
  .dash-row{display:flex;justify-content:space-between;align-items:flex-start;gap:12px;padding:10px 0;border-bottom:1px solid rgba(255,255,255,.025);font-size:12px}
  .dash-row:last-child{border-bottom:none}
  .dash-row-l{color:var(--text-2);flex-shrink:0}
  .tag{padding:3px 9px;border-radius:5px;font-size:10px;font-weight:600;white-space:normal;max-width:280px;text-align:right;line-height:1.4}
  .tag-pass{background:var(--success-dim);color:var(--success)}
  .tag-warn{background:var(--warn-dim);color:var(--warn)}
  .tag-fail{background:var(--danger-dim);color:var(--danger)}
  .tag-info{background:var(--info-dim);color:var(--info)}
  .risk-wrap{margin-top:8px}
  .risk-label{display:flex;justify-content:space-between;font-size:10px;color:var(--text-3);margin-bottom:4px}
  .risk-bar{height:5px;border-radius:3px;background:var(--bg-4);overflow:hidden}
  .risk-fill{height:100%;border-radius:3px;transition:width .8s ease}
  .dash-summary{padding:10px 20px 16px;font-size:11px;color:var(--text-3);line-height:1.5;border-top:1px solid var(--border);font-style:italic}
  .dash-actions{margin-top:24px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap}

  /* Overall Score */
  .score-banner{margin-top:20px;background:var(--bg-2);border-radius:var(--r-lg);border:1px solid var(--border);padding:28px 32px;display:flex;align-items:center;gap:32px}
  .score-ring-wrap{position:relative;width:100px;height:100px;flex-shrink:0}
  .score-ring-wrap svg{width:100%;height:100%;transform:rotate(-90deg)}
  .sr-bg{fill:none;stroke:var(--bg-4);stroke-width:7}
  .sr-fill{fill:none;stroke:url(#sg);stroke-width:7;stroke-linecap:round;stroke-dasharray:264;transition:stroke-dashoffset 1s ease}
  .score-num{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
  .score-val{font-family:var(--font-d);font-size:32px;color:var(--accent);line-height:1}
  .score-max{font-size:10px;color:var(--text-3)}
  .score-text{flex:1}
  .score-verdict{font-size:15px;font-weight:600;margin-bottom:6px}
  .score-sub{font-size:13px;color:var(--text-2);line-height:1.6}
  .rec-list{margin-top:12px;display:flex;flex-direction:column;gap:6px}
  .rec-item{font-size:12px;color:var(--text-1);display:flex;align-items:flex-start;gap:8px}
  .rec-item::before{content:'â†’';color:var(--accent);font-weight:700;flex-shrink:0}

  /* FDA */
  .fda-box{background:var(--bg-1);border:1px solid var(--border);border-left:4px solid var(--accent);border-radius:0 var(--r-lg) var(--r-lg) 0;padding:36px 40px;position:relative;overflow:hidden}
  .fda-box::before{content:'Â§';position:absolute;right:30px;top:12px;font-family:var(--font-d);font-size:120px;font-weight:700;color:rgba(255,255,255,.012);line-height:1}
  .fda-title{font-family:var(--font-d);font-size:24px;font-weight:700;margin-bottom:4px}
  .fda-cn{font-family:var(--font-cn);font-size:14px;color:var(--text-2);margin-bottom:24px}
  .fda-cols{display:grid;grid-template-columns:1fr 1fr;gap:36px}
  .fda-col h4{font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:1.5px;color:var(--accent);margin-bottom:14px;font-family:var(--font-m)}
  .fda-text{font-size:13px;color:var(--text-1);line-height:1.75}
  .fda-text p{margin-bottom:10px}
  .fda-hl{margin-top:12px;padding:14px 16px;background:var(--accent-glow2);border:1px solid rgba(45,212,168,.1);border-radius:var(--r)}
  .fda-hl-t{font-size:12px;font-weight:700;color:var(--accent);margin-bottom:8px}
  .fda-kl{list-style:none;display:flex;flex-direction:column;gap:6px}
  .fda-kl li{font-size:12px;color:var(--text-1);display:flex;align-items:center;gap:8px}
  .fda-kl li::before{content:'âœ“';color:var(--accent);font-weight:700;font-size:10px;width:18px;height:18px;border-radius:5px;background:var(--accent-glow);display:flex;align-items:center;justify-content:center;flex-shrink:0}

  /* Footer */
  footer{padding:36px var(--pad);border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center;margin-top:40px}
  .footer-l{font-size:11px;color:var(--text-3)}
  .footer-r{display:flex;gap:20px}
  .footer-r a{font-size:11px;color:var(--text-3);transition:color .2s}
  .footer-r a:hover{color:var(--accent)}

  /* CN */
  .cn .hero h1,.cn .sec-title,.cn .fda-title,.cn .ly-title{font-family:var(--font-cn);letter-spacing:0}
  .cn .hero-desc,.cn .sec-desc,.cn .svc-d,.cn .ly-desc,.cn .dash-row-l,.cn .fda-text,.cn .info-item,.cn .score-sub,.cn .rec-item,.cn .dash-summary{font-family:var(--font-cn)}

  /* Responsive */
  @media(max-width:1200px){.svc-grid{grid-template-columns:repeat(3,1fr)}}
  @media(max-width:900px){.svc-grid{grid-template-columns:repeat(2,1fr)}.layers{grid-template-columns:1fr}.dash-grid{grid-template-columns:1fr}.fda-cols{grid-template-columns:1fr;gap:24px}.upload-row{grid-template-columns:1fr}.score-banner{flex-direction:column;text-align:center}}
  @media(max-width:600px){.svc-grid{grid-template-columns:1fr}.nav-r .nav-link{display:none}.fda-box{padding:24px 20px}}

  /* hide result sections initially */
  #resultsSection{display:none}
  #resultsSection.visible{display:block;animation:fu .5s ease both}

  /* Report Full-Screen Overlay */
  .report-overlay{display:none;position:fixed;inset:0;z-index:200;background:var(--bg-0);overflow-y:auto;animation:fu .3s ease both}
  .report-overlay.active{display:block}
  .report-inner{max-width:960px;margin:0 auto;padding:32px 40px 60px}
  .report-close{position:fixed;top:16px;right:24px;z-index:201;width:40px;height:40px;border-radius:10px;background:var(--bg-3);border:1px solid var(--border);color:var(--text-0);font-size:18px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
  .report-close:hover{background:var(--danger);border-color:var(--danger)}
  .report-header{text-align:center;padding:24px 0 32px;border-bottom:2px solid var(--border-accent);margin-bottom:32px}
  .report-brand{font-family:var(--font-d);font-size:14px;color:var(--accent);margin-bottom:8px}
  .report-title{font-family:var(--font-d);font-size:28px;font-weight:700;margin-bottom:8px}
  .report-meta{font-size:11px;color:var(--text-3);font-family:var(--font-m)}
  .report-note{margin-top:12px;padding:10px 16px;background:var(--bg-2);border:1px solid var(--border);border-radius:8px;font-size:10px;color:var(--text-3);line-height:1.5;text-align:left;display:inline-block;max-width:600px}
  /* Bigger dash card styles in overlay */
  .report-overlay .dash-card{background:var(--bg-1);border:1px solid var(--border);border-radius:var(--r-lg)}
  .report-overlay .dash-hd{padding:18px 24px}
  .report-overlay .dash-t{font-size:16px}
  .report-overlay .dash-body{padding:20px 24px}
  .report-overlay .dash-row{padding:12px 0;font-size:14px}
  .report-overlay .dash-row-l{font-size:14px;font-weight:500}
  .report-overlay .tag{font-size:12px;padding:4px 12px}
  .report-overlay .dash-summary{font-size:13px;padding:14px 24px}
  .report-overlay .risk-label{font-size:12px}
  .report-overlay .risk-bar{height:7px}
  .report-overlay .score-banner{padding:32px 36px}
  .report-overlay .score-val{font-size:40px}
  .report-overlay .score-verdict{font-size:18px}
  .report-overlay .score-sub{font-size:14px}
  .report-overlay .rec-item{font-size:13px}
  /* Regulatory footnote */
  .reg-ref{display:block;font-size:10px;color:var(--text-3);font-family:var(--font-m);margin-top:3px;font-style:normal}
  .facility-note{margin-top:10px;padding:10px 14px;background:var(--info-dim);border-radius:8px;font-size:11px;color:var(--info);line-height:1.5}
  .platform-note{padding:12px 24px;font-size:10px;color:var(--text-3);line-height:1.5;border-top:1px solid var(--border);font-style:italic}
</style>
</head>
<body id="app">
<svg style="position:absolute;width:0;height:0"><defs><linearGradient id="sg" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#2DD4A8"/><stop offset="100%" stop-color="#60A5FA"/></linearGradient></defs></svg>

<!-- NAV -->
<nav>
  <div class="nav-brand">
    <div class="nav-logo">GT</div>
    <div class="nav-name">GoTo<em>Market</em></div>
  </div>
  <div class="nav-r">
    <span class="nav-link active" onclick="sTo('hero')" data-en="Home" data-cn="é¦–é¡µ">Home</span>
    <span class="nav-link" onclick="sTo('services')" data-en="Services" data-cn="æœåŠ¡">Services</span>
    <span class="nav-link" onclick="sTo('layers')" data-en="Model" data-cn="æœåŠ¡æ¨¡å‹">Model</span>
    <span class="nav-link" onclick="sTo('dashboard')" data-en="Report" data-cn="æŠ¥å‘Š">Report</span>
    <span class="nav-link" onclick="sTo('fda')" data-en="FDA Info" data-cn="FDA è¯´æ˜">FDA Info</span>
    <div class="lang-sw">
      <button class="lang-btn active" id="lEn" onclick="setLang('en')">EN</button>
      <button class="lang-btn" id="lCn" onclick="setLang('cn')">ä¸­æ–‡</button>
    </div>
  </div>
</nav>

<!-- HERO -->
<section class="hero" id="hero">
  <div class="hero-orb hero-orb-1"></div>
  <div class="hero-orb hero-orb-2"></div>
  <div class="hero-grid"></div>
  <div class="hero-inner">
    <div class="hero-badge" data-en="Global Regulatory & Market Entry Intelligence Platform" data-cn="å…¨çƒåˆè§„ä¸å¸‚åœºæ‹“å±•æ™ºèƒ½å¹³å°">Global Regulatory & Market Entry Intelligence Platform</div>
    <h1 data-en='Product <em>Compliance Risk Review</em>' data-cn='äº§å“<em>åˆè§„é£é™©å®¡æŸ¥</em>'>Product <em>Compliance Risk Review</em></h1>
    <p class="hero-desc" data-en="AI-powered regulatory risk screening for food and dietary supplement exports to the U.S. market." data-cn="åŸºäº AI çš„é£Ÿå“åŠè†³é£Ÿè¡¥å……å‰‚å‡ºå£ç¾å›½å¸‚åœºåˆè§„é£é™©ç­›æŸ¥ã€‚">AI-powered regulatory risk screening for food and dietary supplement exports to the U.S. market.</p>
    <div class="hero-actions">
      <button class="btn btn-accent" onclick="sTo('uploadArea')" data-en="âš¡ Start Risk Screening" data-cn="âš¡ å¼€å§‹é£é™©ç­›æŸ¥">âš¡ Start Risk Screening</button>
      <button class="btn btn-ghost" onclick="document.getElementById('fInput').click()" data-en="ğŸ“ Upload Product Files" data-cn="ğŸ“ ä¸Šä¼ äº§å“èµ„æ–™">ğŸ“ Upload Product Files</button>
    </div>
    <!-- /hero-actions -->
  </div>
  <!-- /hero-inner â€” upload lives outside to get full width -->

  <!-- Upload -->
  <div class="upload-row" id="uploadArea">
    <div class="upload-zone" id="upZone" ondragover="event.preventDefault();this.classList.add('dragover')" ondragleave="this.classList.remove('dragover')" ondrop="handleDrop(event)" onclick="document.getElementById('fInput').click()">
      <input type="file" id="fInput" accept="image/jpeg,image/png,image/webp,application/pdf" multiple style="display:none" onchange="handleFiles(this.files)">
      <div class="upload-icon-wrap" id="upIcon">ğŸ“¦</div>
      <div class="upload-title" data-en="Drop product files here" data-cn="æ‹–æ”¾äº§å“èµ„æ–™åˆ°æ­¤å¤„">Drop product files here</div>
      <div class="upload-desc" data-en="Supports multiple files Â· packaging photos, labels, ingredients" data-cn="æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼  Â· åŒ…è£…ç…§ç‰‡ã€æ ‡ç­¾ã€é…æ–™è¡¨">Supports multiple files Â· packaging photos, labels, ingredients</div>
      <div class="upload-formats"><span class="fmt">JPG</span><span class="fmt">PNG</span><span class="fmt">PDF</span><span class="fmt">MULTI</span></div>
      <div class="file-list" id="fileList"></div>
    </div>
    <div class="upload-info">
      <div class="info-title" data-en="ğŸ“‹ Report modules" data-cn="ğŸ“‹ æŠ¥å‘ŠåŒ…å«æ¨¡å—">ğŸ“‹ Report modules</div>
      <div class="info-list">
        <div class="info-item"><div class="info-dot" style="background:var(--accent-glow)">ğŸ§ª</div><div><div class="iit-t" data-en="Ingredient Risk Screening" data-cn="æˆåˆ†é£é™©ç­›æŸ¥">Ingredient Risk Screening</div><div class="iit-d" data-en="AI analysis of ingredient legality & risk" data-cn="AI æˆåˆ†åˆæ³•æ€§ä¸é£é™©åˆ†æ">AI analysis of ingredient legality & risk</div></div></div>
        <div class="info-item"><div class="info-dot" style="background:var(--gold-dim)">ğŸ·ï¸</div><div><div class="iit-t" data-en="Label Structure Optimization" data-cn="æ ‡ç­¾ç»“æ„ä¼˜åŒ–">Label Structure Optimization</div><div class="iit-d" data-en="Nutrition facts, allergens, labeling" data-cn="è¥å…»æˆåˆ†è¡¨ã€è¿‡æ•åŸã€æ ‡ç­¾è§„èŒƒ">Nutrition facts, allergens, labeling</div></div></div>
        <div class="info-item"><div class="info-dot" style="background:var(--info-dim)">ğŸ­</div><div><div class="iit-t" data-en="Facility Registration Status" data-cn="å·¥å‚æ³¨å†ŒçŠ¶æ€æ ¸æŸ¥">Facility Registration Status</div><div class="iit-d" data-en="FDA registration verification" data-cn="FDA å·¥å‚æ³¨å†ŒéªŒè¯">FDA registration verification</div></div></div>
        <div class="info-item"><div class="info-dot" style="background:var(--warn-dim)">âš–ï¸</div><div><div class="iit-t" data-en="Regulatory Advisory Referral" data-cn="æ³•è§„é¡¾é—®å¯¹æ¥">Regulatory Advisory Referral</div><div class="iit-d" data-en="US regulatory consultant connection" data-cn="ç¾å›½æ³•è§„é¡¾é—®å¯¹æ¥">US regulatory consultant connection</div></div></div>
        <div class="info-item"><div class="info-dot" style="background:var(--success-dim)">ğŸš€</div><div><div class="iit-t" data-en="Market Readiness Advisory" data-cn="å¸‚åœºå‡†å¤‡åº¦è¯„ä¼°">Market Readiness Advisory</div><div class="iit-d" data-en="Go-to-market readiness assessment" data-cn="ä¸Šå¸‚å‡†å¤‡åº¦è¯„ä¼°">Go-to-market readiness assessment</div></div></div>
      </div>
    </div>
  </div>

  <!-- Analyze Bar -->
  <div class="analyze-bar" id="analyzeBar" style="display:none">
    <button class="btn btn-accent" id="analyzeBtn" onclick="startAnalysis()">
      <span data-en="ğŸ” Analyze with AI" data-cn="ğŸ” AI æ™ºèƒ½åˆ†æ">ğŸ” Analyze with AI</span>
    </button>
    <span class="analyze-status" id="analyzeStatus"></span>
  </div>
</section>

<div class="divider"></div>

<!-- CORE SERVICES -->
<section class="section" id="services">
  <div class="sec-label" data-en="Core Modules" data-cn="æ ¸å¿ƒæ¨¡å—">Core Modules</div>
  <div class="sec-title" data-en="Compliance Service Modules" data-cn="åˆè§„æœåŠ¡æ¨¡å—">Compliance Service Modules</div>
  <div class="sec-desc" data-en="Five integrated modules covering every aspect of your product's regulatory journey." data-cn="äº”å¤§é›†æˆæ¨¡å—ï¼Œè¦†ç›–äº§å“åˆè§„ä¹‹æ—…çš„æ¯ä¸ªç¯èŠ‚ã€‚">Five integrated modules covering every aspect of your product's regulatory journey.</div>
  <div class="svc-grid">
    <div class="svc-card"><div class="svc-icon" style="background:var(--accent-glow)">ğŸ§ª</div><div class="svc-num">01</div><div class="svc-t" data-en="Ingredient Risk Screening" data-cn="æˆåˆ†é£é™©ç­›æŸ¥">Ingredient Risk Screening</div><div class="svc-d" data-en="Screen against FDA GRAS list, banned substances, and dietary supplement regulations." data-cn="æ¯”å¯¹ FDA GRAS æ¸…å•ã€ç¦ç”¨ç‰©è´¨åŠè†³é£Ÿè¡¥å……å‰‚æ³•è§„ã€‚">Screen against FDA GRAS list, banned substances, and dietary supplement regulations.</div></div>
    <div class="svc-card"><div class="svc-icon" style="background:var(--gold-dim)">ğŸ·ï¸</div><div class="svc-num">02</div><div class="svc-t" data-en="Label Structure Optimization" data-cn="æ ‡ç­¾ç»“æ„ä¼˜åŒ–">Label Structure Optimization</div><div class="svc-d" data-en="Review nutrition facts, allergens, net weight, and required label statements." data-cn="å®¡æŸ¥è¥å…»æˆåˆ†è¡¨ã€è¿‡æ•åŸã€å‡€å«é‡åŠå¿…éœ€æ ‡æ³¨ã€‚">Review nutrition facts, allergens, net weight, and required label statements.</div></div>
    <div class="svc-card"><div class="svc-icon" style="background:var(--info-dim)">ğŸ­</div><div class="svc-num">03</div><div class="svc-t" data-en="Facility Registration Check" data-cn="å·¥å‚æ³¨å†Œæ ¸æŸ¥">Facility Registration Check</div><div class="svc-d" data-en="Verify FDA registration, US Agent, and FSVP importer compliance." data-cn="éªŒè¯ FDA æ³¨å†Œã€ç¾å›½ä»£ç†äººåŠ FSVP è¿›å£å•†åˆè§„ã€‚">Verify FDA registration, US Agent, and FSVP importer compliance.</div></div>
    <div class="svc-card"><div class="svc-icon" style="background:var(--warn-dim)">âš–ï¸</div><div class="svc-num">04</div><div class="svc-t" data-en="Regulatory Advisory Referral" data-cn="æ³•è§„é¡¾é—®å¯¹æ¥">Regulatory Advisory Referral</div><div class="svc-d" data-en="Connect with US regulatory consultants for professional guidance." data-cn="å¯¹æ¥ç¾å›½æ³•è§„é¡¾é—®è·å–ä¸“ä¸šæŒ‡å¯¼ã€‚">Connect with US regulatory consultants for professional guidance.</div></div>
    <div class="svc-card"><div class="svc-icon" style="background:var(--success-dim)">ğŸš€</div><div class="svc-num">05</div><div class="svc-t" data-en="Market Readiness Advisory" data-cn="å¸‚åœºå‡†å¤‡åº¦è¯„ä¼°">Market Readiness Advisory</div><div class="svc-d" data-en="Evaluate overall go-to-market readiness and entry strategy." data-cn="è¯„ä¼°æ•´ä½“ä¸Šå¸‚å‡†å¤‡åº¦ä¸è¿›å…¥ç­–ç•¥ã€‚">Evaluate overall go-to-market readiness and entry strategy.</div></div>
  </div>
</section>

<div class="divider"></div>

<!-- LAYERED MODEL -->
<section class="section" id="layers">
  <div class="sec-label" data-en="Service Architecture" data-cn="æœåŠ¡æ¶æ„">Service Architecture</div>
  <div class="sec-title" data-en="Three-Layer Service Model" data-cn="ä¸‰å±‚æœåŠ¡ç»“æ„">Three-Layer Service Model</div>
  <div class="sec-desc" data-en="From automated screening to expert legal consultation." data-cn="ä»è‡ªåŠ¨åŒ–ç­›æŸ¥åˆ°ä¸“å®¶æ³•åŠ¡å’¨è¯¢ã€‚">From automated screening to expert legal consultation.</div>
  <div class="layers">
    <div class="ly-card ly-1"><div class="ly-bar"></div><div class="ly-hd"><div class="ly-num">01</div><div class="ly-tag" data-en="Layer 1" data-cn="ç¬¬ä¸€å±‚">Layer 1</div><div class="ly-title" data-en="Digital Screening" data-cn="åœ¨çº¿åˆè§„ç­›æŸ¥">Digital Screening</div><div class="ly-cn" data-en="Online Compliance Screening" data-cn="AI è¿›è¡Œåˆæ­¥é£é™©è¯†åˆ«">Online Compliance Screening</div></div><div class="ly-desc" data-en="AI-powered initial risk identification. Automated ingredient analysis, label format checking, and preliminary compliance scoring. Future integration with toxicology and regulatory databases." data-cn="AI é©±åŠ¨çš„åˆæ­¥é£é™©è¯†åˆ«ã€‚è‡ªåŠ¨åŒ–æˆåˆ†åˆ†æã€æ ‡ç­¾æ ¼å¼æ£€æŸ¥å’Œåˆæ­¥åˆè§„è¯„åˆ†ã€‚åæœŸå°†æ¥å…¥æ¯’ç†æ•°æ®åº“ä¸æ³•è§„æ•°æ®åº“ã€‚">AI-powered initial risk identification. Automated ingredient analysis, label format checking, and preliminary compliance scoring. Future integration with toxicology and regulatory databases.</div></div>
    <div class="ly-card ly-2"><div class="ly-bar"></div><div class="ly-hd"><div class="ly-num">02</div><div class="ly-tag" data-en="Layer 2" data-cn="ç¬¬äºŒå±‚">Layer 2</div><div class="ly-title" data-en="Advisory Optimization" data-cn="äººå·¥åˆè§„ä¼˜åŒ–">Advisory Optimization</div><div class="ly-cn" data-en="Manual Compliance Optimization" data-cn="äººå·¥åˆ†ææ ‡ç­¾ã€æˆåˆ†ä¸è¡¨è¾¾">Manual Compliance Optimization</div></div><div class="ly-desc" data-en="Expert human review of labels, ingredient declarations, and marketing language. Professional optimization of compliance structure and bilingual content accuracy." data-cn="ä¸“å®¶äººå·¥å®¡æŸ¥æ ‡ç­¾ã€æˆåˆ†å£°æ˜åŠå®£ä¼ è¯­è¨€ã€‚ä¸“ä¸šä¼˜åŒ–åˆè§„ç»“æ„ä¸åŒè¯­å†…å®¹å‡†ç¡®æ€§ã€‚">Expert human review of labels, ingredient declarations, and marketing language. Professional optimization of compliance structure and bilingual content accuracy.</div></div>
    <div class="ly-card ly-3"><div class="ly-bar"></div><div class="ly-hd"><div class="ly-num">03</div><div class="ly-tag" data-en="Layer 3" data-cn="ç¬¬ä¸‰å±‚">Layer 3</div><div class="ly-title" data-en="Market Entry & Brand Strategy" data-cn="å¸‚åœºæ‹“å±•ä¸å“ç‰Œæˆ˜ç•¥">Market Entry & Brand Strategy</div><div class="ly-cn" data-en="Sales Channels, Legal & Global Expansion" data-cn="é”€å”®æ¸ é“ Â· æ³•åŠ¡å¯¹æ¥ Â· å…¨çƒåŒ–æˆ˜ç•¥è§„åˆ’">Sales Channels, Legal & Global Expansion</div></div><div class="ly-desc" data-en="Sales channel development, legal counsel engagement, and strategic market expansion planning. Ensure compliant brand positioning and global distribution readiness." data-cn="é”€å”®æ¸ é“å¼€å‘ã€æ³•åŠ¡é¡¾é—®å¯¹æ¥åŠæˆ˜ç•¥æ€§å¸‚åœºæ‹“å±•è§„åˆ’ã€‚æå‡å“ç‰Œå…¨çƒç«äº‰åŠ›ï¼Œç¡®ä¿å“ç‰Œåœ¨ç›®æ ‡å¸‚åœºçš„åˆè§„é”€å”®ä¸å¯æŒç»­å¢é•¿ã€‚">Sales channel development, legal counsel engagement, and strategic market expansion planning. Ensure compliant brand positioning and global distribution readiness.</div></div>
  </div>
</section>

<div class="divider"></div>

<!-- DASHBOARD / REPORT -->
<section class="section" id="dashboard">
  <div class="sec-label" data-en="Compliance Report" data-cn="åˆè§„æŠ¥å‘Š">Compliance Report</div>
  <div class="sec-title" data-en="Compliance Risk & Structural Assessment" data-cn="äº§å“åˆè§„é£é™©ä¸ç»“æ„è¯„ä¼°æŠ¥å‘Š">Compliance Risk & Structural Assessment</div>
  <div class="sec-desc" data-en="Upload product files for AI-powered regulatory risk analysis. Full report opens in a dedicated view." data-cn="ä¸Šä¼ äº§å“èµ„æ–™è¿›è¡Œ AI åˆè§„é£é™©åˆ†æã€‚å®Œæ•´æŠ¥å‘Šå°†åœ¨ç‹¬ç«‹é¡µé¢å±•ç¤ºã€‚">Upload product files for AI-powered regulatory risk analysis. Full report opens in a dedicated view.</div>

  <!-- Dynamic results rendered here -->
  <div id="reportContent">
    <!-- Default demo content -->
    <div class="dash-grid">
      <div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ§ª <span data-en="Ingredient Risk Overview" data-cn="æˆåˆ†é£é™©æ¦‚è§ˆ">Ingredient Risk Overview</span></span><span class="tag tag-warn" data-en="3 Flags" data-cn="3 é¡¹æ ‡è®°">3 Flags</span></div><div class="dash-body"><div class="dash-row"><span class="dash-row-l" data-en="Sodium Benzoate (E211)" data-cn="è‹¯ç”²é…¸é’  (E211)">Sodium Benzoate (E211)</span><span class="tag tag-pass">GRAS</span></div><div class="dash-row"><span class="dash-row-l" data-en="Red No. 40 (Allura Red)" data-cn="è¯±æƒ‘çº¢40å·">Red No. 40 (Allura Red)</span><span class="tag tag-warn" data-en="Requires Listing" data-cn="éœ€æ ‡æ³¨">Requires Listing</span></div><div class="dash-row"><span class="dash-row-l" data-en="Steviol Glycosides" data-cn="ç”œèŠç³–è‹·">Steviol Glycosides</span><span class="tag tag-pass">GRAS</span></div><div class="dash-row"><span class="dash-row-l" data-en="Titanium Dioxide (E171)" data-cn="äºŒæ°§åŒ–é’› (E171)">Titanium Dioxide (E171)</span><span class="tag tag-fail" data-en="Review" data-cn="éœ€å®¡æŸ¥">Review</span></div><div class="risk-wrap"><div class="risk-label"><span data-en="Risk Level" data-cn="é£é™©ç­‰çº§">Risk Level</span><span data-en="Medium" data-cn="ä¸­ç­‰">Medium</span></div><div class="risk-bar"><div class="risk-fill" style="width:55%;background:linear-gradient(90deg,var(--success),var(--warn))"></div></div></div></div></div>
      <div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ·ï¸ <span data-en="Label Compliance Review" data-cn="æ ‡ç­¾åˆè§„å®¡æŸ¥">Label Compliance Review</span></span><span class="tag tag-pass">7/9</span></div><div class="dash-body"><div class="dash-row"><span class="dash-row-l" data-en="Nutrition Facts (2020)" data-cn="è¥å…»æˆåˆ†è¡¨ (2020)">Nutrition Facts (2020)</span><span class="tag tag-pass" data-en="Pass" data-cn="é€šè¿‡">Pass</span></div><div class="dash-row"><span class="dash-row-l" data-en="Allergen Declaration" data-cn="è¿‡æ•åŸå£°æ˜">Allergen Declaration</span><span class="tag tag-warn" data-en="Review" data-cn="å¾…å®¡æŸ¥">Review</span></div><div class="dash-row"><span class="dash-row-l" data-en="Net Weight (Dual)" data-cn="å‡€å«é‡ï¼ˆåŒå•ä½ï¼‰">Net Weight (Dual)</span><span class="tag tag-fail" data-en="Missing oz" data-cn="ç¼ºå°‘ oz">Missing oz</span></div><div class="dash-row"><span class="dash-row-l" data-en="Country of Origin" data-cn="åŸäº§å›½">Country of Origin</span><span class="tag tag-pass" data-en="Pass" data-cn="é€šè¿‡">Pass</span></div></div></div>
      <div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ­ <span data-en="Facility Registration" data-cn="å·¥å‚æ³¨å†ŒçŠ¶æ€">Facility Registration</span></span><span class="tag tag-info" data-en="Pending Verification" data-cn="å¾…æ ¸éªŒ">Pending Verification</span></div><div class="dash-body"><div class="dash-row"><span class="dash-row-l" data-en="FDA Facility (FEI)" data-cn="FDA è®¾æ–½ç¼–å· (FEI)">FDA Facility (FEI)</span><span class="tag tag-info" data-en="Verify with facility" data-cn="éœ€ä¸å·¥å‚ç¡®è®¤">Verify with facility</span></div><div class="dash-row"><span class="dash-row-l" data-en="DUNS Number" data-cn="DUNS ç¼–å·">DUNS Number</span><span class="tag tag-info" data-en="Verify with facility" data-cn="éœ€ä¸å·¥å‚ç¡®è®¤">Verify with facility</span></div><div class="dash-row"><span class="dash-row-l" data-en="FSVP Importer" data-cn="FSVP è¿›å£å•†">FSVP Importer</span><span class="tag tag-warn" data-en="Pending" data-cn="å¾…ç¡®è®¤">Pending</span></div><div style="margin-top:8px;padding:8px 10px;background:var(--info-dim);border-radius:8px;font-size:10px;color:var(--info);line-height:1.5" data-en="Note: Facility FEI/DUNS information must be confirmed with the manufacturer and verified as currently active." data-cn="æ³¨ï¼šéœ€ä¸å·¥å‚ç¡®è®¤æ˜¯å¦æŒæœ‰è®¾æ–½ FEI æˆ– DUNS ç¼–å·ï¼Œå¹¶ç¡®ä¿åœ¨æœ‰æ•ˆæœŸå†…ã€‚">Note: Facility FEI/DUNS information must be confirmed with the manufacturer and verified as currently active.</div></div><div class="dash-summary" data-en="This platform does not directly access FDA internal databases. Verification is based on publicly available information and client-provided documentation." data-cn="æœ¬å¹³å°ä¸ç›´æ¥è®¿é—® FDA å†…éƒ¨æ•°æ®åº“ï¼Œä»…åŸºäºå…¬å¼€ä¿¡æ¯ä¸å®¢æˆ·æä¾›èµ„æ–™è¿›è¡Œæ ¸æŸ¥ã€‚">This platform does not directly access FDA internal databases. Verification is based on publicly available information and client-provided documentation.</div></div>
      <div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ’¬ <span data-en="Marketing Claim Risk" data-cn="å®£ä¼ è¯­è¨€é£é™©">Marketing Claim Risk</span></span><span class="tag tag-warn" data-en="2 Issues" data-cn="2 é¡¹é—®é¢˜">2 Issues</span></div><div class="dash-body"><div class="dash-row"><span class="dash-row-l">"All Natural"</span><span class="tag tag-warn" data-en="Vague" data-cn="æ¨¡ç³Š">Vague</span></div><div class="dash-row"><span class="dash-row-l">"Boosts Immunity"</span><span class="tag tag-fail" data-en="Unauthorized" data-cn="æœªæˆæƒ">Unauthorized</span></div><div class="dash-row"><span class="dash-row-l">"Low Sugar"</span><span class="tag tag-pass" data-en="OK" data-cn="åˆè§„">OK</span></div><div class="risk-wrap"><div class="risk-label"><span data-en="Claim Risk" data-cn="å®£ç§°é£é™©">Claim Risk</span><span data-en="High" data-cn="è¾ƒé«˜">High</span></div><div class="risk-bar"><div class="risk-fill" style="width:72%;background:linear-gradient(90deg,var(--warn),var(--danger))"></div></div></div></div></div>
    </div>
    <div class="dash-actions">
      <button class="btn btn-accent btn-sm" onclick="requestConsult()" data-en="ğŸ’¬ Request Expert Consultation" data-cn="ğŸ’¬ ç”³è¯·äººå·¥å’¨è¯¢" style="background:linear-gradient(135deg,var(--accent),var(--accent-dim))">ğŸ’¬ Request Expert Consultation</button>
      <button class="btn btn-ghost btn-sm" onclick="exportPDF()" data-en="â¬‡ Export PDF Report" data-cn="â¬‡ å¯¼å‡º PDF æŠ¥å‘Š">â¬‡ Export PDF Report</button>
    </div>
  </div>
</section>

<div class="divider"></div>

<!-- FDA DISCLAIMER -->
<section class="section" id="fda" style="padding-bottom:40px">
  <div class="fda-box">
    <div class="fda-title" data-en="Understanding FDA Registration" data-cn="å…³äº FDA æ³¨å†Œçš„é‡è¦è¯´æ˜">Understanding FDA Registration</div>
    <div class="fda-cn" data-en="Important clarification for food and supplement exporters" data-cn="é£Ÿå“åŠè†³é£Ÿè¡¥å……å‰‚å‡ºå£å•†çš„é‡è¦è¯´æ˜">Important clarification for food and supplement exporters</div>
    <div class="fda-cols">
      <div class="fda-col"><h4>English</h4><div class="fda-text"><p>For dietary supplements and food products, the U.S. FDA <strong style="color:var(--accent)">does not approve individual products</strong>.</p><p>FDA registration applies to <strong>manufacturing facilities</strong>, not to single SKUs or brand names.</p><p>There is no such thing as an "FDA product certification" for supplements.</p><div class="fda-hl"><div class="fda-hl-t">What truly matters:</div><ul class="fda-kl"><li>Ingredient legality</li><li>Proper labeling structure</li><li>Valid facility registration</li><li>Regulatory-compliant marketing claims</li></ul></div></div></div>
      <div class="fda-col"><h4>ä¸­æ–‡</h4><div class="fda-text" style="font-family:var(--font-cn)"><p>å¯¹äºè†³é£Ÿè¡¥å……å‰‚åŠé£Ÿå“ç±»äº§å“ï¼Œç¾å›½ FDA <strong style="color:var(--accent)">ä¸å¯¹å•ä¸ªäº§å“è¿›è¡Œå®¡æ‰¹æˆ–è®¤è¯</strong>ã€‚</p><p>FDA æ³¨å†Œé’ˆå¯¹çš„æ˜¯<strong>ç”Ÿäº§è®¾æ–½ï¼ˆå·¥å‚ï¼‰</strong>ï¼Œè€Œéå…·ä½“äº§å“æˆ–å“ç‰Œã€‚</p><p>å¸‚åœºä¸Šæ‰€è°“"FDAäº§å“è®¤è¯"å¹¶ä¸å­˜åœ¨ã€‚</p><div class="fda-hl"><div class="fda-hl-t">çœŸæ­£å½±å“äº§å“åˆè§„æ€§çš„å…³é”®åœ¨äºï¼š</div><ul class="fda-kl"><li>æˆåˆ†åˆæ³•æ€§</li><li>æ ‡ç­¾ç»“æ„è§„èŒƒ</li><li>å·¥å‚æ³¨å†ŒçŠ¶æ€æœ‰æ•ˆ</li><li>å®£ä¼ è¯­è¨€ç¬¦åˆç›‘ç®¡è¦æ±‚</li></ul></div></div></div>
    </div>
  </div>
</section>

<footer>
  <div class="footer-l"><span data-en="Â© 2026 GoToMarket Compliance Lab. For informational purposes only." data-cn="Â© 2026 GoToMarket Compliance Lab. ä»…ä¾›ä¿¡æ¯å‚è€ƒã€‚">Â© 2026 GoToMarket Compliance Lab. For informational purposes only.</span></div>
  <div class="footer-r"><a href="#" data-en="Privacy" data-cn="éšç§æ”¿ç­–">Privacy</a><a href="#" data-en="Terms" data-cn="æœåŠ¡æ¡æ¬¾">Terms</a><a href="#" data-en="Contact" data-cn="è”ç³»æˆ‘ä»¬">Contact</a></div>
</footer>
<div style="text-align:center;padding:0 var(--pad) 24px;font-size:10px;color:var(--text-3);opacity:0.7;line-height:1.6;font-family:var(--font-cn)"><span data-en="This platform provides structural compliance assessment and risk advisory only. It does not constitute legal advice, regulatory approval, or official certification." data-cn="æœ¬å¹³å°æä¾›çš„æ˜¯ç»“æ„æ€§åˆè§„è¯„ä¼°ä¸é£é™©æç¤ºï¼Œä¸æ„æˆæ³•å¾‹æ„è§æˆ–ç›‘ç®¡æ‰¹å‡†ã€‚">This platform provides structural compliance assessment and risk advisory only. It does not constitute legal advice, regulatory approval, or official certification.</span></div>

<!-- Report Full-Screen Overlay -->
<div class="report-overlay" id="reportOverlay">
  <button class="report-close" onclick="closeReport()">âœ•</button>
  <div class="report-inner" id="reportOverlayContent"></div>
</div>

<script>
// ===== State =====
let lang='en', uploadedFiles=[], lastReportData=null;

// ===== Lang =====
function setLang(l){
  lang=l;
  document.getElementById('lEn').classList.toggle('active',l==='en');
  document.getElementById('lCn').classList.toggle('active',l==='cn');
  document.body.classList.toggle('cn',l==='cn');
  document.querySelectorAll('[data-en]').forEach(el=>{
    const v=el.getAttribute(l==='en'?'data-en':'data-cn');
    if(el.tagName==='INPUT'||el.tagName==='TEXTAREA')el.placeholder=v;
    else el.innerHTML=v;
  });
}

function sTo(id){document.getElementById(id)?.scrollIntoView({behavior:'smooth',block:'start'})}

// ===== Upload =====
function handleDrop(e){e.preventDefault();e.target.closest('.upload-zone')?.classList.remove('dragover');if(e.dataTransfer.files.length)handleFiles(e.dataTransfer.files)}

function handleFiles(files){
  const ok=['image/jpeg','image/png','image/webp','application/pdf'];
  for(const f of files){if(ok.includes(f.type))uploadedFiles.push(f)}
  renderFiles();
}

function removeFile(i){uploadedFiles.splice(i,1);renderFiles()}

function renderFiles(){
  const list=document.getElementById('fileList');
  const bar=document.getElementById('analyzeBar');
  if(!uploadedFiles.length){list.innerHTML='';document.getElementById('upIcon').textContent='ğŸ“¦';bar.style.display='none';return}
  document.getElementById('upIcon').textContent='âœ…';
  bar.style.display='flex';
  list.innerHTML=uploadedFiles.map((f,i)=>{
    const ext=f.name.split('.').pop().toUpperCase();
    const icon=ext==='PDF'?'ğŸ“„':'ğŸ–¼ï¸';
    const sz=f.size>1048576?(f.size/1048576).toFixed(1)+' MB':(f.size/1024).toFixed(0)+' KB';
    return `<div class="file-item" style="animation-delay:${i*0.04}s"><span>${icon}</span><span class="fn">${f.name}</span><span class="fs">${sz}</span><button class="fx" onclick="event.stopPropagation();removeFile(${i})">âœ•</button></div>`;
  }).join('');
}

// ===== Analysis =====
async function startAnalysis(){
  if(!uploadedFiles.length)return;
  const btn=document.getElementById('analyzeBtn');
  const status=document.getElementById('analyzeStatus');
  btn.disabled=true;
  btn.style.opacity='.6';
  status.className='analyze-status';
  status.innerHTML=`<span class="spinner"></span>${lang==='cn'?'æ­£åœ¨åˆ†æä¸­ï¼Œè¯·ç¨å€™...':'Analyzing with AI, please wait...'}`;

  const formData=new FormData();
  formData.append('lang',lang);
  uploadedFiles.forEach(f=>formData.append('files',f));

  try{
    const res=await fetch('/api/analyze',{method:'POST',body:formData});
    const json=await res.json();
    if(!res.ok){
      const detail=json.raw?`\n\nServer raw: ${json.raw.substring(0,200)}...`:'';
      throw new Error((json.error||'Analysis failed')+detail);
    }
    if(json.demo){
      status.innerHTML=lang==='cn'?'âš ï¸ æ¼”ç¤ºæ¨¡å¼ â€” è¯·é…ç½® GEMINI_API_KEY è·å–çœŸå®åˆ†æ':'âš ï¸ Demo mode â€” configure GEMINI_API_KEY for real analysis';
    } else {
      status.innerHTML=lang==='cn'?'âœ… åˆ†æå®Œæˆ':'âœ… Analysis complete';
    }
    renderReport(json.data);
    setTimeout(()=>sTo('dashboard'),300);
  }catch(err){
    status.className='analyze-status error';
    status.textContent=`âŒ ${err.message}`;
  }finally{
    btn.disabled=false;
    btn.style.opacity='1';
  }
}

// ===== Render Report (Full-Screen Overlay) =====
function renderReport(d){
  lastReportData=d;
  const cn=lang==='cn';
  const now=new Date();
  const dateStr=now.toLocaleDateString(cn?'zh-CN':'en-US',{year:'numeric',month:'long',day:'numeric'});
  const reportId='GTM-'+Date.now().toString(36).toUpperCase();

  function tagClass(s){return s==='pass'?'tag-pass':s==='warn'?'tag-warn':s==='fail'?'tag-fail':'tag-info'}
  function riskGrad(p){return p>65?'linear-gradient(90deg,var(--warn),var(--danger))':p>35?'linear-gradient(90deg,var(--success),var(--warn))':'linear-gradient(90deg,var(--success),var(--accent))'}

  let html='';
  // Report Header
  html+=`<div class="report-header">
    <div class="report-brand">GoToMarket Compliance Lab</div>
    <div class="report-title">${cn?'äº§å“åˆè§„é£é™©ä¸ç»“æ„è¯„ä¼°æŠ¥å‘Š':'Product Compliance Risk & Structural Assessment Report'}</div>
    <div class="report-meta">${cn?'æŠ¥å‘Šæ—¥æœŸ':'Report Date'}: ${dateStr}ã€€|ã€€ID: ${reportId}</div>
    <div class="report-note">${cn?'æœ¬æŠ¥å‘Šç”± AI ç³»ç»ŸåŸºäºä¸Šä¼ èµ„æ–™è‡ªåŠ¨ç”Ÿæˆï¼Œä»…ä½œä¸ºç»“æ„æ€§åˆè§„é£é™©å‚è€ƒï¼Œä¸æ„æˆæ³•å¾‹æ„è§ã€‚æœ€ç»ˆåˆè§„ç¡®è®¤è¯·å’¨è¯¢æŒç‰Œæ³•è§„é¡¾é—®ã€‚':'This report is auto-generated by AI based on uploaded materials for structural compliance risk reference only. It does not constitute legal advice. Please consult licensed regulatory professionals for final confirmation.'}</div>
  </div>`;

  html+='<div class="dash-grid">';

  // Ingredient Risk - with regulatory citations
  const ir=d.ingredientRisk;
  html+=`<div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ§ª ${cn?'æˆåˆ†é£é™©æ¦‚è§ˆ':'Ingredient Risk Overview'}</span><span class="tag ${tagClass(ir.status)}">${ir.flagCount} ${cn?'é¡¹æ ‡è®°':'Flags'}</span></div><div class="dash-body">`;
  ir.items.forEach(it=>{
    const name=cn?(it.nameCn||it.name):it.name;
    const note=it.note||it.status;
    html+=`<div class="dash-row"><span class="dash-row-l">${name}<span class="reg-ref">${it.regulation||''}</span></span><span class="tag ${tagClass(it.status)}">${note}</span></div>`;
  });
  html+=`<div class="risk-wrap"><div class="risk-label"><span>${cn?'é£é™©ç­‰çº§':'Risk Level'}</span><span>${cn?(ir.overallRisk==='high'?'é«˜é£é™©':ir.overallRisk==='medium'?'ä¸­ç­‰é£é™©':'ä½é£é™©'):ir.overallRisk}</span></div><div class="risk-bar"><div class="risk-fill" style="width:${ir.riskPercent}%;background:${riskGrad(ir.riskPercent)}"></div></div></div>`;
  if(ir.summary)html+=`</div><div class="dash-summary">${ir.summary}</div>`;
  html+=`</div>`;

  // Label Compliance
  const lc=d.labelCompliance;
  html+=`<div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ·ï¸ ${cn?'æ ‡ç­¾åˆè§„å®¡æŸ¥':'Label Compliance Review'}</span><span class="tag ${tagClass(lc.status)}">${lc.passCount}/${lc.totalCount}</span></div><div class="dash-body">`;
  lc.items.forEach(it=>{
    const name=cn?(it.nameCn||it.name):it.name;
    html+=`<div class="dash-row"><span class="dash-row-l">${name}<span class="reg-ref">${it.regulation||''}</span></span><span class="tag ${tagClass(it.status)}">${it.note||it.status}</span></div>`;
  });
  if(lc.summary)html+=`</div><div class="dash-summary">${lc.summary}</div>`;
  html+=`</div>`;

  // Facility Registration - with FEI/DUNS note
  const fr=d.facilityRegistration;
  html+=`<div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ­ ${cn?'å·¥å‚æ³¨å†ŒçŠ¶æ€':'Facility Registration'}</span><span class="tag ${tagClass(fr.status)}">${cn?'å¾…æ ¸éªŒ':'Pending Verification'}</span></div><div class="dash-body">`;
  fr.items.forEach(it=>{
    const name=cn?(it.nameCn||it.name):it.name;
    html+=`<div class="dash-row"><span class="dash-row-l">${name}<span class="reg-ref">${it.regulation||''}</span></span><span class="tag ${tagClass(it.status)}">${it.value||it.status}</span></div>`;
  });
  html+=`<div class="facility-note">${cn?'æ³¨ï¼šéœ€ä¸å·¥å‚ç¡®è®¤æ˜¯å¦æŒæœ‰è®¾æ–½ FEI æˆ– DUNS ç¼–å·ï¼Œå¹¶ç¡®ä¿åœ¨æœ‰æ•ˆæœŸå†…ã€‚':'Note: Facility FEI/DUNS information must be confirmed with the manufacturer and verified as currently active.'}</div>`;
  html+=`</div><div class="platform-note">${cn?'æœ¬å¹³å°ä¸ç›´æ¥è®¿é—® FDA å†…éƒ¨æ•°æ®åº“ï¼Œä»…åŸºäºå…¬å¼€ä¿¡æ¯ä¸å®¢æˆ·æä¾›èµ„æ–™è¿›è¡Œæ ¸æŸ¥ã€‚':'This platform does not directly access FDA internal databases. Verification is based on publicly available information and client-provided documentation.'}</div></div>`;

  // Marketing Claims
  const mc=d.marketingClaims;
  html+=`<div class="dash-card"><div class="dash-hd"><span class="dash-t">ğŸ’¬ ${cn?'å®£ä¼ è¯­è¨€é£é™©':'Marketing Claim Risk'}</span><span class="tag ${tagClass(mc.status)}">${mc.issueCount} ${cn?'é¡¹é—®é¢˜':'Issues'}</span></div><div class="dash-body">`;
  mc.items.forEach(it=>{
    const claim=cn?(it.claimCn||it.claim):it.claim;
    html+=`<div class="dash-row"><span class="dash-row-l">${claim}<span class="reg-ref">${it.regulation||''}</span></span><span class="tag ${tagClass(it.status)}">${it.note||it.status}</span></div>`;
  });
  html+=`<div class="risk-wrap"><div class="risk-label"><span>${cn?'å®£ç§°é£é™©':'Claim Risk'}</span><span>${cn?(mc.riskLevel==='high'?'è¾ƒé«˜':mc.riskLevel==='medium'?'ä¸­ç­‰':'ä½'):mc.riskLevel}</span></div><div class="risk-bar"><div class="risk-fill" style="width:${mc.riskPercent}%;background:${riskGrad(mc.riskPercent)}"></div></div></div>`;
  if(mc.summary)html+=`</div><div class="dash-summary">${mc.summary}</div>`;
  html+=`</div></div>`;

  // Score Banner
  const sc=d.overallScore;
  const circ=264;
  const off=circ-(circ*sc/100);
  const recs=cn?(d.recommendationsCn||d.recommendations):d.recommendations;
  html+=`<div class="score-banner"><div class="score-ring-wrap"><svg viewBox="0 0 90 90"><circle class="sr-bg" cx="45" cy="45" r="42"/><circle class="sr-fill" cx="45" cy="45" r="42" style="stroke-dashoffset:${off}"/></svg><div class="score-num"><div class="score-val">${sc}</div><div class="score-max">/100</div></div></div><div class="score-text"><div class="score-verdict">${cn?'ç»¼åˆåˆè§„é£é™©è¯„åˆ†':'Overall Compliance Risk Score'}</div><div class="score-sub">${cn?(d.overallVerdictCn||d.overallVerdict):d.overallVerdict}</div>`;
  if(recs&&recs.length){
    html+=`<div class="rec-list">`;
    recs.forEach(r=>{html+=`<div class="rec-item">${r}</div>`});
    html+=`</div>`;
  }
  html+=`</div></div>`;

  // Actions - only 2 buttons
  html+=`<div class="dash-actions">
    <button class="btn btn-accent btn-sm" onclick="requestConsult()" style="background:linear-gradient(135deg,var(--accent),var(--accent-dim))">ğŸ’¬ ${cn?'ç”³è¯·äººå·¥å’¨è¯¢':'Request Expert Consultation'}</button>
    <button class="btn btn-ghost btn-sm" onclick="exportPDF()">â¬‡ ${cn?'å¯¼å‡º PDF æŠ¥å‘Š':'Export PDF Report'}</button>
  </div>`;

  // Legal footer
  html+=`<div style="text-align:center;padding:24px 0 0;font-size:10px;color:var(--text-3);opacity:0.6;line-height:1.6">${cn?'æœ¬å¹³å°æä¾›çš„æ˜¯ç»“æ„æ€§åˆè§„è¯„ä¼°ä¸é£é™©æç¤ºï¼Œä¸æ„æˆæ³•å¾‹æ„è§æˆ–ç›‘ç®¡æ‰¹å‡†ã€‚':'This platform provides structural compliance assessment and risk advisory only. It does not constitute legal advice, regulatory approval, or official certification.'}</div>`;

  // Open in overlay
  const overlay=document.getElementById('reportOverlay');
  document.getElementById('reportOverlayContent').innerHTML=html;
  overlay.classList.add('active');
  document.body.style.overflow='hidden';
}

function closeReport(){
  document.getElementById('reportOverlay').classList.remove('active');
  document.body.style.overflow='';
}

function requestConsult(){
  const cn=lang==='cn';
  alert(cn?'æ„Ÿè°¢æ‚¨çš„å’¨è¯¢è¯·æ±‚ï¼æˆ‘ä»¬çš„åˆè§„é¡¾é—®å°†åœ¨ 24 å°æ—¶å†…ä¸æ‚¨è”ç³»ã€‚\n\nå¦‚éœ€å³æ—¶å’¨è¯¢ï¼Œè¯·å‘é€é‚®ä»¶è‡³ï¼šcompliance@gotomarket-lab.com':'Thank you for your consultation request! Our compliance advisor will contact you within 24 hours.\n\nFor immediate inquiries, please email: compliance@gotomarket-lab.com');
}

// ===== PDF Export (Professional with Cover, TOC, Disclaimer) =====
function exportPDF(){
  const d = lastReportData || getDemoReportData();
  const {jsPDF} = window.jspdf;
  const doc = new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});
  const W=210, H=297, M=18, CW=W-M*2;
  const now=new Date();
  const dateStr=now.toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});
  const reportId='GTM-'+Date.now().toString(36).toUpperCase();

  const C={
    accent:[13,147,115], accentLight:[240,250,246],
    dark:[26,26,46], mid:[100,100,120], light:[150,150,170],
    white:[255,255,255], bg:[245,247,250],
    pass:[22,163,74], passBg:[220,252,231],
    warn:[217,119,6], warnBg:[254,243,199],
    fail:[220,38,38], failBg:[254,226,226],
    info:[37,99,235], infoBg:[219,234,254],
    border:[229,231,235], recBg:[255,251,235], recBorder:[253,230,138]
  };
  function statusColor(s){return s==='pass'?C.pass:s==='warn'?C.warn:s==='fail'?C.fail:C.info}
  let y=M;
  function checkPage(need){if(y+need>H-20){doc.addPage();y=M;return true}return false}
  function pageFooter(){
    doc.setFontSize(7);doc.setTextColor(...C.light);
    doc.text('GoToMarket Compliance Lab  |  Confidential',M,H-10);
    doc.text(`Page ${doc.internal.getNumberOfPages()}`,W-M,H-10,{align:'right'});
  }

  // ======== PAGE 1: COVER ========
  doc.setFillColor(...C.accent);
  doc.rect(0,0,W,H,'F');
  // White content area
  doc.setFillColor(...C.white);
  doc.roundedRect(M,M,CW,H-M*2,4,4,'F');
  // Brand
  doc.setFont('helvetica','bold');doc.setFontSize(14);doc.setTextColor(...C.accent);
  doc.text('GoToMarket Compliance Lab',M+16,M+24);
  doc.setFont('helvetica','normal');doc.setFontSize(9);doc.setTextColor(...C.mid);
  doc.text('Global Regulatory & Market Entry Intelligence Platform',M+16,M+31);
  // Divider
  doc.setDrawColor(...C.accent);doc.setLineWidth(1);
  doc.line(M+16,M+38,M+CW-16,M+38);
  // Title
  doc.setFont('helvetica','bold');doc.setFontSize(26);doc.setTextColor(...C.dark);
  doc.text('Product Compliance Risk',M+16,M+62);
  doc.text('& Structural Assessment Report',M+16,M+72);
  // Score
  doc.setFillColor(...C.accentLight);
  doc.roundedRect(M+16,M+86,CW-32,28,3,3,'F');
  doc.setFillColor(...C.white);doc.setDrawColor(...C.accent);doc.setLineWidth(1.5);
  doc.circle(M+32,M+100,10,'FD');
  doc.setFont('helvetica','bold');doc.setFontSize(20);doc.setTextColor(...C.accent);
  doc.text(String(d.overallScore),M+32,M+102,{align:'center'});
  doc.setFont('helvetica','bold');doc.setFontSize(12);doc.setTextColor(...C.dark);
  doc.text('Overall Compliance Risk Score',M+48,M+96);
  doc.setFont('helvetica','normal');doc.setFontSize(8);doc.setTextColor(...C.mid);
  const vd=d.overallVerdict||'';
  doc.text(doc.splitTextToSize(vd,CW-68),M+48,M+102);
  // Meta
  doc.setFont('helvetica','normal');doc.setFontSize(9);doc.setTextColor(...C.mid);
  doc.text(`Report Date: ${dateStr}`,M+16,M+130);
  doc.text(`Report ID: ${reportId}`,M+16,M+137);
  // Disclaimer box
  doc.setFillColor(248,249,250);doc.setDrawColor(...C.border);doc.setLineWidth(0.3);
  doc.roundedRect(M+16,H-M-70,CW-32,30,2,2,'FD');
  doc.setFont('helvetica','bold');doc.setFontSize(8);doc.setTextColor(...C.mid);
  doc.text('DISCLAIMER',M+20,H-M-62);
  doc.setFont('helvetica','normal');doc.setFontSize(7);doc.setTextColor(...C.light);
  const disc='This report is generated by AI for structural compliance risk reference only. It does not constitute legal advice, regulatory approval, or official certification. The U.S. FDA does not approve individual food or dietary supplement products. FDA registration applies to manufacturing facilities per 21 CFR 1.225. This platform does not directly access FDA internal databases. Final compliance must be confirmed by licensed regulatory professionals.';
  doc.text(doc.splitTextToSize(disc,CW-40),M+20,H-M-56);
  // Bottom brand bar
  doc.setFillColor(...C.accent);
  doc.rect(M,H-M-28,CW,28,'F');
  doc.setFont('helvetica','bold');doc.setFontSize(10);doc.setTextColor(...C.white);
  doc.text('GoToMarket Compliance Lab',M+16,H-M-16);
  doc.setFont('helvetica','normal');doc.setFontSize(7);doc.setTextColor(176,232,216);
  doc.text(`(c) ${now.getFullYear()} GoToMarket Compliance Lab. All rights reserved.`,M+16,H-M-10);

  // ======== PAGE 2: TABLE OF CONTENTS ========
  doc.addPage();
  y=M;
  doc.setFillColor(...C.accent);doc.rect(0,0,W,3,'F');
  y=20;
  doc.setFont('helvetica','bold');doc.setFontSize(18);doc.setTextColor(...C.dark);
  doc.text('Table of Contents',M,y);
  y+=4;doc.setDrawColor(...C.accent);doc.setLineWidth(0.5);doc.line(M,y,M+50,y);
  y+=14;
  const toc=[
    ['1','Ingredient Risk Assessment','ingredientRisk'],
    ['2','Label Compliance Review','labelCompliance'],
    ['3','Facility Registration Status','facilityRegistration'],
    ['4','Marketing Claim Risk Analysis','marketingClaims'],
    ['5','Recommendations & Action Items','recommendations'],
    ['6','Disclaimer & Legal Notice','disclaimer']
  ];
  toc.forEach(([num,title])=>{
    doc.setFont('helvetica','bold');doc.setFontSize(10);doc.setTextColor(...C.accent);
    doc.text(num+'.',M,y);
    doc.setFont('helvetica','normal');doc.setFontSize(10);doc.setTextColor(...C.dark);
    doc.text(title,M+10,y);
    y+=9;
  });
  pageFooter();

  // ======== SECTION PAGES ========
  function drawSection(icon,title,sectionNum,badgeText,badgeStatus,items,nameKey,noteKey,summary,riskPercent,riskLabel,extraNote){
    doc.addPage();y=M;
    doc.setFillColor(...C.accent);doc.rect(0,0,W,3,'F');
    y=16;
    doc.setFont('helvetica','bold');doc.setFontSize(8);doc.setTextColor(...C.accent);
    doc.text(`SECTION ${sectionNum}`,M,y);
    y+=7;
    doc.setFont('helvetica','bold');doc.setFontSize(14);doc.setTextColor(...C.dark);
    doc.text(`${title}`,M,y);
    y+=4;doc.setDrawColor(...C.accent);doc.setLineWidth(0.5);doc.line(M,y,M+40,y);
    y+=8;

    const tableData=items.map(it=>{
      const name=it[nameKey+'Cn']||it[nameKey]||'';
      const note=it[noteKey]||it.status||'';
      const reg=it.regulation||'';
      return [name,note,reg];
    });
    doc.autoTable({
      startY:y, margin:{left:M,right:M},
      head:[['Item','Assessment','Regulation']],
      body:tableData,
      theme:'striped',
      styles:{fontSize:8,cellPadding:{top:3,bottom:3,left:3,right:3},textColor:C.dark,lineColor:C.border,lineWidth:0.15},
      headStyles:{fillColor:C.bg,textColor:C.mid,fontStyle:'bold',fontSize:7},
      columnStyles:{0:{cellWidth:CW*0.3},1:{cellWidth:CW*0.42},2:{cellWidth:CW*0.28,fontStyle:'italic',textColor:C.light,fontSize:7}},
      didParseCell:function(data){
        if(data.section==='body'&&data.column.index===1){
          const st=items[data.row.index]?.status;
          if(st)data.cell.styles.textColor=statusColor(st);
        }
      }
    });
    y=doc.lastAutoTable.finalY+6;

    if(typeof riskPercent==='number'){
      checkPage(12);
      doc.setFontSize(7);doc.setTextColor(...C.light);
      doc.text(riskLabel||'Risk Level',M,y+2);
      const rl=riskPercent>65?'HIGH':riskPercent>35?'MEDIUM':'LOW';
      doc.text(rl,W-M,y+2,{align:'right'});
      y+=4;
      doc.setFillColor(...C.border);doc.roundedRect(M,y,CW,3,1,1,'F');
      const rc=riskPercent>65?C.fail:riskPercent>35?C.warn:C.pass;
      doc.setFillColor(...rc);doc.roundedRect(M,y,CW*riskPercent/100,3,1,1,'F');
      y+=8;
    }
    if(summary){
      checkPage(14);
      doc.setFillColor(250,250,250);doc.roundedRect(M,y,CW,12,2,2,'F');
      doc.setFont('helvetica','italic');doc.setFontSize(8);doc.setTextColor(...C.light);
      doc.text(doc.splitTextToSize(summary,CW-8),M+4,y+5);
      y+=16;
    }
    if(extraNote){
      checkPage(14);
      doc.setFillColor(...C.infoBg);doc.roundedRect(M,y,CW,12,2,2,'F');
      doc.setFont('helvetica','normal');doc.setFontSize(7);doc.setTextColor(...C.info);
      doc.text(doc.splitTextToSize(extraNote,CW-8),M+4,y+5);
      y+=16;
    }
    pageFooter();
  }

  const ir=d.ingredientRisk;
  drawSection('','Ingredient Risk Assessment','1',`${ir.flagCount} Flags`,ir.status,ir.items,'name','note',ir.summary,ir.riskPercent,'Risk Level');

  const lc=d.labelCompliance;
  drawSection('','Label Compliance Review','2',`${lc.passCount}/${lc.totalCount}`,lc.status,lc.items,'name','note',lc.summary);

  const fr=d.facilityRegistration;
  drawSection('','Facility Registration Status','3','Pending',fr.status,fr.items,'name','value',fr.summary,null,null,
    'Note: Facility FEI/DUNS information must be confirmed with the manufacturer. This platform does not directly access FDA internal databases; verification is based on publicly available information and client-provided documentation.');

  const mc=d.marketingClaims;
  drawSection('','Marketing Claim Risk Analysis','4',`${mc.issueCount} Issues`,mc.status,mc.items,'claim','note',mc.summary,mc.riskPercent,'Claim Risk');

  // ======== RECOMMENDATIONS PAGE ========
  const recs=d.recommendations||[];
  if(recs.length){
    doc.addPage();y=M;
    doc.setFillColor(...C.accent);doc.rect(0,0,W,3,'F');
    y=16;
    doc.setFont('helvetica','bold');doc.setFontSize(8);doc.setTextColor(...C.accent);
    doc.text('SECTION 5',M,y);y+=7;
    doc.setFont('helvetica','bold');doc.setFontSize(14);doc.setTextColor(...C.dark);
    doc.text('Recommendations & Action Items',M,y);
    y+=4;doc.setDrawColor(...C.accent);doc.setLineWidth(0.5);doc.line(M,y,M+40,y);y+=10;

    doc.setFillColor(...C.recBg);doc.setDrawColor(...C.recBorder);doc.setLineWidth(0.3);
    const recH=8+recs.length*8;
    doc.roundedRect(M,y,CW,recH,3,3,'FD');
    let ry=y+6;
    recs.forEach((r,i)=>{
      doc.setFont('helvetica','bold');doc.setFontSize(8);doc.setTextColor(146,64,14);
      doc.text(`${i+1}.`,M+4,ry);
      doc.setFont('helvetica','normal');doc.setFontSize(8);doc.setTextColor(120,53,15);
      doc.text(doc.splitTextToSize(r,CW-16),M+12,ry);
      ry+=8;
    });
    pageFooter();
  }

  // ======== DISCLAIMER PAGE ========
  doc.addPage();y=M;
  doc.setFillColor(...C.accent);doc.rect(0,0,W,3,'F');
  y=16;
  doc.setFont('helvetica','bold');doc.setFontSize(8);doc.setTextColor(...C.accent);
  doc.text('SECTION 6',M,y);y+=7;
  doc.setFont('helvetica','bold');doc.setFontSize(14);doc.setTextColor(...C.dark);
  doc.text('Disclaimer & Legal Notice',M,y);
  y+=4;doc.setDrawColor(...C.accent);doc.setLineWidth(0.5);doc.line(M,y,M+40,y);y+=10;

  const disclaimers=[
    'This report is generated by the GoToMarket Compliance Lab AI system for structural compliance risk reference purposes only.',
    'This report does not constitute legal advice, regulatory approval, or official certification of any kind.',
    'For dietary supplements and food products, the U.S. FDA does not approve or certify individual products. FDA registration applies to manufacturing facilities (21 CFR 1.225), not to specific products or brands.',
    'This platform does not directly access FDA internal databases. All verification is based on publicly available information and documentation provided by the client.',
    'Final product compliance determination must be made by licensed regulatory professionals and/or qualified legal counsel.',
    'GoToMarket Compliance Lab assumes no liability for actions taken based on the contents of this report.'
  ];
  disclaimers.forEach((d,i)=>{
    doc.setFont('helvetica','normal');doc.setFontSize(9);doc.setTextColor(...C.dark);
    const lines=doc.splitTextToSize(`${i+1}. ${d}`,CW-8);
    doc.text(lines,M+4,y);
    y+=lines.length*4.5+4;
  });

  y+=10;
  doc.setFillColor(...C.accent);doc.roundedRect(M,y,CW,20,3,3,'F');
  doc.setFont('helvetica','bold');doc.setFontSize(10);doc.setTextColor(...C.white);
  doc.text('GoToMarket Compliance Lab',M+8,y+8);
  doc.setFont('helvetica','normal');doc.setFontSize(7);doc.setTextColor(176,232,216);
  doc.text(`(c) ${now.getFullYear()} GoToMarket Compliance Lab. All rights reserved.`,M+8,y+14);
  pageFooter();

  doc.save(`GoToMarket_Compliance_Report_${now.toISOString().split('T')[0]}.pdf`);
}

// Demo data fallback
function getDemoReportData(){
  return {
    ingredientRisk:{status:'warn',flagCount:3,items:[
      {name:'Sodium Benzoate (E211)',nameCn:'Sodium Benzoate / è‹¯ç”²é…¸é’ ',status:'pass',note:'FDA-affirmed GRAS status. Permitted as preservative under specified concentration limits.',regulation:'21 CFR 184.1733'},
      {name:'Red No. 40 (Allura Red)',nameCn:'Red No. 40 / è¯±æƒ‘çº¢40å·',status:'warn',note:'Certified color additive. Requires batch certification and specific label declaration.',regulation:'21 CFR 74.340'},
      {name:'Steviol Glycosides',nameCn:'Steviol Glycosides / ç”œèŠç³–è‹·',status:'pass',note:'GRAS self-affirmed per FDA no-objection letters. Verify purity specifications â‰¥95%.',regulation:'21 CFR 170.30 (GRAS); GRN No. 252'},
      {name:'Titanium Dioxide (E171)',nameCn:'Titanium Dioxide / äºŒæ°§åŒ–é’›',status:'fail',note:'Subject to ongoing FDA safety review. Confirm compliance with current guidance before use.',regulation:'21 CFR 73.575; FDA Safety Review 2024'}
    ],overallRisk:'medium',riskPercent:55,summary:'3 ingredient flags identified. Recommend verification of GRAS status and color additive certification prior to market entry.'},
    labelCompliance:{status:'warn',passCount:7,totalCount:9,items:[
      {name:'Nutrition Facts Panel',nameCn:'Nutrition Facts / è¥å…»æˆåˆ†è¡¨',status:'pass',note:'Compliant with updated format requirements.',regulation:'21 CFR 101.9 (2020 Final Rule)'},
      {name:'Allergen Declaration',nameCn:'Allergen Declaration / è¿‡æ•åŸå£°æ˜',status:'warn',note:'Major allergen (wheat) requires "Contains" statement or bold type declaration.',regulation:'FALCPA Sec. 203; 21 CFR 101.4'},
      {name:'Net Quantity (Dual Units)',nameCn:'Net Quantity / å‡€å«é‡',status:'fail',note:'Missing U.S. customary units. Both metric and customary required.',regulation:'21 CFR 101.105'},
      {name:'Country of Origin',nameCn:'Country of Origin / åŸäº§å›½',status:'pass',note:'Properly declared per marking requirements.',regulation:'19 CFR 134'},
      {name:'Product Identity Statement',nameCn:'Product Identity / äº§å“æ ‡è¯†',status:'pass',note:'Common name displayed on principal display panel.',regulation:'21 CFR 101.3'}
    ],summary:'7 of 9 label compliance checks passed. 2 items require correction before distribution.'},
    facilityRegistration:{status:'info',items:[
      {name:'FDA Facility Registration (FEI)',nameCn:'FDA Facility Registration / FDAè®¾æ–½æ³¨å†Œ',value:'Pending â€” confirm with manufacturer',status:'info',regulation:'21 CFR 1.225; FSMA Sec. 301'},
      {name:'DUNS Number',nameCn:'DUNS Number / DUNSç¼–å·',value:'Pending â€” confirm with manufacturer',status:'info',regulation:'FDA UFI Requirement'},
      {name:'FSVP Importer Compliance',nameCn:'FSVP Importer / FSVPè¿›å£å•†',value:'Pending verification',status:'warn',regulation:'21 CFR Part 1 Subpart L'}
    ],summary:'Facility FEI and DUNS information must be confirmed with manufacturer and verified as currently active per 21 CFR 1.225.'},
    marketingClaims:{status:'warn',issueCount:2,items:[
      {claim:'"All Natural"',claimCn:'"All Natural" / "çº¯å¤©ç„¶"',status:'warn',note:'No FDA formal definition for "natural." Risk of enforcement action for misleading labeling.',regulation:'FD&C Act Sec. 403(a)(1); FDA Policy Notice 1991'},
      {claim:'"Boosts Immunity"',claimCn:'"Boosts Immunity" / "å¢å¼ºå…ç–«åŠ›"',status:'fail',note:'Constitutes unauthorized health claim. Requires FDA pre-market authorization or qualified health claim petition.',regulation:'DSHEA Sec. 403(r)(6); 21 CFR 101.93'},
      {claim:'"Low Sugar"',claimCn:'"Low Sugar" / "ä½ç³–"',status:'pass',note:'Meets nutrient content claim criteria if product contains â‰¤5g sugar per RACC.',regulation:'21 CFR 101.60(c)'}
    ],riskLevel:'high',riskPercent:72,summary:'2 marketing claim issues identified. Unauthorized health claim presents significant regulatory risk.'},
    overallScore:65,
    overallVerdict:'Moderate compliance risk. Multiple items require corrective action prior to U.S. market distribution.',
    overallVerdictCn:'åˆè§„é£é™©ç­‰çº§ä¸ºä¸­ç­‰ã€‚å¤šé¡¹å†…å®¹éœ€åœ¨ç¾å›½å¸‚åœºé”€å”®å‰å®Œæˆæ•´æ”¹ã€‚',
    recommendations:[
      'Add U.S. customary weight units (oz) per 21 CFR 101.105',
      'Add allergen "Contains" statement or bold declaration per FALCPA Sec. 203',
      'Remove unauthorized health claim "Boosts Immunity" or file qualified health claim petition with FDA',
      'Clarify or remove "All Natural" claim to avoid FD&C Act Sec. 403(a)(1) violation',
      'Confirm facility FEI number and DUNS with manufacturer per 21 CFR 1.225'
    ],
    recommendationsCn:[
      'ä¾æ® 21 CFR 101.105 æ·»åŠ ç¾åˆ¶é‡é‡å•ä½ (oz)',
      'ä¾æ® FALCPA Sec. 203 æ·»åŠ è¿‡æ•åŸ"å«æœ‰"å£°æ˜æˆ–åŠ ç²—æ ‡æ³¨',
      'åˆ é™¤æœªç»æˆæƒçš„å¥åº·å£°ç§°"å¢å¼ºå…ç–«åŠ›"ï¼Œæˆ–å‘ FDA æäº¤åˆæ ¼å¥åº·å£°ç§°ç”³è¯·',
      'æ˜ç¡®"çº¯å¤©ç„¶"å£°ç§°å«ä¹‰æˆ–ç§»é™¤ï¼Œé¿å…è¿å FD&C Act Sec. 403(a)(1)',
      'ä¾æ® 21 CFR 1.225 ä¸å·¥å‚ç¡®è®¤è®¾æ–½ FEI ç¼–å·åŠ DUNS ä¿¡æ¯'
    ]
  };
}

// ===== PPT Export =====
async function exportPPTX(){
  const d = lastReportData || getDemoReportData();
  const cn = lang==='cn';

  // Show loading state on button
  const btns = document.querySelectorAll('[onclick="exportPPTX()"]');
  btns.forEach(b=>{b.disabled=true;b.style.opacity='.6';b.textContent=cn?'â³ ç”Ÿæˆä¸­...':'â³ Generating...'});

  try {
    const res = await fetch('/api/generate-slides', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ data: d, lang })
    });

    if (!res.ok) {
      const err = await res.json();
      throw new Error(err.error || 'Failed to generate slides');
    }

    // Download the blob
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `GoToMarket_Compliance_Report_${new Date().toISOString().split('T')[0]}.pptx`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  } catch (err) {
    alert(`PPT export failed: ${err.message}`);
  } finally {
    btns.forEach(b=>{b.disabled=false;b.style.opacity='1';b.textContent=cn?'ğŸ“Š å¯¼å‡º PPT':'ğŸ“Š Export PPT'});
  }
}

// ===== Scroll Reveal =====
const obs=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting){e.target.style.opacity='1';e.target.style.transform='translateY(0)'}})},{threshold:.08});
document.querySelectorAll('.section,.fda-box').forEach(el=>{el.style.opacity='0';el.style.transform='translateY(24px)';el.style.transition='opacity .6s ease,transform .6s ease';obs.observe(el)});
</script>

</body>
</html>